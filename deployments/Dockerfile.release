FROM elixir:1.5-alpine

ENV MIX_ENV prod
ENV PORT 4000

RUN mkdir /gyro
WORKDIR /gyro
COPY ./_build/${MIX_ENV}/rel/gyro/releases/${MIX_VERSION}/gyro.tar.gz ./
RUN tar ./gyro.tar.gz
RUN rm ./gyro.tar.gz

EXPOSE ${PORT}
ENTRYPOINT ["./bin/gyro"]
CMD ["./bin/gyro", "foreground"]
